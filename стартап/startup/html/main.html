<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MedQueue – Удобная запись в клиники Алматы</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/styles.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="../js/script.js"></script>
  <style>

    /* ---- Map ---- */
    .hero-map {
      border-radius: 20px;
      overflow: hidden;
      height: 400px;
      min-width: 340px;
      flex: 1;
      box-shadow: 0 16px 48px rgba(0,0,0,0.22);
      border: 3px solid rgba(255,255,255,0.35);
      position: relative;
    }
    #hospitalsMap {
      width: 100%;
      height: 100%;
    }
    .leaflet-popup-content-wrapper {
      border-radius: 14px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.18);
    }
    .map-popup-btn {
      display: block;
      margin-top: 10px;
      padding: 8px 0;
      background: linear-gradient(135deg,#16a34a,#15803d);
      color: white;
      text-align: center;
      border-radius: 9px;
      text-decoration: none;
      font-weight: 700;
      font-size: 13px;
    }
    .map-popup-btn:hover { opacity: .88; }

    .filter-tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
      flex-wrap: wrap;
    }

    .filter-btn {
      padding: 8px 16px;
      border-radius: 8px;
      border: 1px solid rgba(22, 163, 74, 0.2);
      background: transparent;
      color: var(--accent);
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 14px;
    }

    .filter-btn:hover {
      background: rgba(22, 163, 74, 0.1);
    }

    .filter-btn.active {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }

    /* ===== DARK THEME OVERRIDES ===== */
    [data-theme="dark"] .filter-btn {
      border-color: rgba(56,189,248,0.20);
      color: var(--accent-2);
    }
    [data-theme="dark"] .filter-btn:hover {
      background: rgba(34,197,94,0.1);
    }
    [data-theme="dark"] .filter-btn.active {
      background: var(--accent);
      color: #fff;
    }
  </style>
  <script src="/js/theme.js"></script>
</head>
<body>

  <header class="site-header">
    <div class="wrap">
      <a class="logo" href="main.html">MedQueue</a>

      <!-- Mobile menu button -->

      <button class="mobile-menu-btn" onclick="toggleMobileMenu()">☰</button>

      <!-- Navigation -->

      <nav id="mainNav">
        <a href="main.html" class="nav-link active">Главная</a>
        <a href="recording.html" class="nav-link">Записаться</a>
        <a href="status.html" class="nav-link">Статус очереди</a>
        <a href="profile.html" class="nav-link">Личный кабинет</a>
      </nav>
    </div>
      <label class="theme-switch"><input type="checkbox" class="theme-checkbox" onchange="toggleTheme()"><span class="theme-slider"></span></label>
  </header>
  <script>

  function toggleMobileMenu() {
    const nav = document.getElementById('mainNav');
    nav.classList.toggle('mobile-open');

  }
  </script>

  <main>

    <section class="hero">
      <div class="wrap hero-inner">
        <div class="hero-left">
          <h1>Меньше очередей – быстрее помощь</h1>
          <p class="lead">Онлайн-запись и динамический статус очереди в поликлиниках Алматы. Выберите клинику, врача и время – мы покажем примерное ожидание.</p>
          <div class="hero-cta">
            <a class="btn btn-primary" href="recording.html">Записаться</a>
            <a class="btn btn-outline" href="status.html">Проверить статус</a>
            <a class="btn btn-outline" href="profile.html">Личный кабинет</a>
            <a class="btn btn-outline" href="contacts%20and%20about.html">О проекте &amp; Контакты</a>
          </div>
        </div>
        <div class="hero-map">
          <div id="hospitalsMap"></div>
        </div>
      </div>
    </section>

    <section class="hospitals wrap">
      <div class="section-head">
        <h2>Клиники Алматы</h2>
        <input id="search" class="search" placeholder="Поиск по названию или адресу..." />
      </div>

      <!-- Фильтры по типу клиник -->

      <div class="filter-tabs">
        <button class="filter-btn active" onclick="filterByType('all', event)">Все клиники</button>
        <button class="filter-btn" onclick="filterByType('Поликлиника', event)">🏥 Поликлиники</button>
        <button class="filter-btn" onclick="filterByType('Детская', event)">👶 Детские</button>
        <button class="filter-btn" onclick="filterByType('Больница', event)">🏨 Больницы</button>
        <button class="filter-btn" onclick="filterByType('Спец. клиника', event)">⚕️ Спец. клиники</button>
      </div>
      <div id="hospList" class="grid"></div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="wrap">
      <div>© 2025 MedQueue – Удобная запись и управление очередями</div>
      <div class="muted">Версия прототипа</div>
    </div>
  </footer>

  <script>
  // GPS-координаты больниц Алматы (по реальным адресам)
  const HOSPITAL_COORDS = {
    // Гос. поликлиники (адреса проверены по 2ГИС)
    'Городская поликлиника №1':                [43.257, 76.907],  // ул. Гоголя, 53
    'Городская поликлиника №2':                [43.259, 76.892],  // ул. Шухова, 37Б
    'Городская поликлиника №3':                [43.259, 76.978],  // ул. Розыбакиева, 74
    'Городская поликлиника №4':                [43.261, 76.896],  // ул. Торайгырова, 12
    'Городская поликлиника №5':                [43.262, 76.915],  // ул. Макатаева, 141
    'Городская поликлиника №6':                [43.248, 76.836],  // 4-й микрорайон, 3а
    'Городская поликлиника №7':                [43.234, 76.925],  // бульв. Бухар жырау, 14
    'Городская поликлиника №9':                [43.280, 76.961],  // ул. Утеген батыра, 21
    'Городская поликлиника №12':               [43.225, 76.931],  // ул. Попова, 23
    'Городская поликлиника №15':               [43.282, 77.038],  // мкр. Жетысу-1, 30
    // Детские поликлиники
    'Детская поликлиника №1':                  [43.256, 76.930],  // ул. Шевченко, 118
    'Детская поликлиника №3':                  [43.249, 76.902],  // ул. Байзакова, 280
    'Детская поликлиника №4':                  [43.278, 76.999],  // Монтажная ул., 33
    'Детская поликлиника №6':                  [43.226, 76.878],  // ул. Саина, 89
    // Больницы
    'Городская клиническая больница №1':       [43.229, 76.802],  // Калкаман мкр., 2
    'Городская клиническая больница №4':       [43.319, 76.963],  // ул. Папанина, 220
    'Городская клиническая больница №7':       [43.232, 76.800],  // Калкаман мкр., 20
    'Центральная городская клиническая больница': [43.204, 76.878],  // ул. Ораза Жандосова, 6
    'Больница скорой медицинской помощи':      [43.255, 76.929],  // ул. Казыбек би, 96
    // Спец. клиники
    'Городская поликлиника ветеранов ВОВ':     [43.260, 76.915],
    'Стоматологическая поликлиника №1':        [43.249, 76.921],
    'Стоматологическая поликлиника №3':        [43.236, 76.931],
    'Кожно-венерологический диспансер':        [43.248, 76.953],
    'Противотуберкулезный диспансер':          [43.243, 76.876],
    // Частные клиники
    'Медицинский центр «Медеу»':               [43.214, 76.948],
    'Клиника «Асем»':                          [43.253, 76.898],
    'Медицинский центр «Interteach»':          [43.247, 76.923],
    'Клиника «VITA»':                          [43.228, 76.942],
    'Медицинский центр «Нур-Медикус»':         [43.225, 76.920],
  };
  // Резервные координаты на случай нового учреждения
  const FALLBACK_POINTS = [
    [43.238, 76.889], [43.270, 76.930], [43.200, 76.860], [43.290, 77.010],
  ];

  const HOSPITAL_ICONS = { 'Поликлиника': '🏥', 'Больница': '🏨', 'Детская': '👶', 'Спец. клиника': '⚕️' };

  function buildMap(hosp) {
    const map = L.map('hospitalsMap', { zoomControl: true, scrollWheelZoom: true })
      .setView([43.238, 76.900], 12);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '© <a href="https://openstreetmap.org">OpenStreetMap</a>',
      maxZoom: 18,
    }).addTo(map);
    hosp.forEach(function(h, i) {
      const coords = HOSPITAL_COORDS[h.name] || FALLBACK_POINTS[i % FALLBACK_POINTS.length];
      const icon = HOSPITAL_ICONS[h.type] || '🏥';
      L.marker(coords, { title: h.name }).addTo(map)
        .bindPopup(
          `<div style="min-width:190px;font-family:Inter,sans-serif;">
            <div style="font-weight:800;font-size:14px;color:#064e3b;margin-bottom:4px;">${icon} ${h.name}</div>
            <div style="font-size:12px;color:#6b7280;margin-bottom:2px;">${h.type}</div>
            <div style="font-size:12px;color:#6b7280;margin-bottom:6px;">📍 ${h.address || ''}</div>
            <div style="font-size:12px;margin-bottom:8px;">Очередь: <b>${h.queue || 0}</b> чел. · ~${h.waiting} мин</div>
            <a class="map-popup-btn" href="recording.html?hospital=${h.id}">Записаться →</a>
          </div>`
        );
    });
  }

  document.addEventListener('hospitalsReady', function() {
    buildMap(window.hospitals);
  });
  </script>
</body>
</html>
